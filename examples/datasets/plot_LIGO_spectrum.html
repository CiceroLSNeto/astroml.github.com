

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Plot the power spectrum of LIGO &mdash; astroML 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/astroMLstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="astroML 0.1 documentation" href="../../index.html" />
    <link rel="up" title="Data set Examples" href="index.html" />
    <link rel="next" title="SDSS Galaxy Colors" href="plot_sdss_galaxy_colors.html" />
    <link rel="prev" title="Corrected Spectra" href="plot_corrected_spectra.html" />
<!-- Following code is for Google custom search bar -->
<script>
  (function() {
    var cx = '011400076584591653333:hjd_fbqk1u0';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script>

<!-- Following code is for toggle/glide features -->
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	
	$(".toggle_container").hide();

	$(".toggle_trigger").click(function(){
		$(this).toggleClass("active").next(".toggle_container").slideToggle("fast");
                return false; <!-- Prevent the link from being followed -->
	});

        $(".toggle_trigger#start_open").toggleClass("active").next().show();

});
</script>

<!-- Following code is for Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35748160-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>
    <div class="header-wrapper"
      <div class="header">
          <p class="logo"><a href="../../index.html">
            <img src="../../_static/Logo.gif" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../../index.html">Home</a></li>
	    <li><a href="../../user_guide/index.html">User Guide</a></li>
            <li><a href="../../book_figures/index.html">Book Figures</a></li>
            <li><a href="../index.html">Examples Plots</a></li>
       </ul>

<!-- Google custom search.  Javascript that enables this is in the header above -->
<div class="search_form">
  <gcse:search></gcse:search>
</div>

          </div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

    <!-- <div id="blue_tile"></div> -->

        <div class="sphinxsidebar">
	<div class="rel">
	
	<!-- rellinks[1:] is an ugly hack to avoid link to module
	    index  -->
	<div class="rellink">
	<a href="plot_corrected_spectra.html" title="Corrected Spectra"
	    accesskey="P">Previous
	    <br>
	    <span class="smallrellink">
	    Corrected Spectr...
	    </span>
	    <span class="hiddenrellink">
	    Corrected Spectra
	    </span>
	    
	    </a>
	</div>
	    <div class="spacer">
	    &nbsp;
	    </div>
	
	<div class="rellink">
	<a href="plot_sdss_galaxy_colors.html" title="SDSS Galaxy Colors"
	    accesskey="N">Next
	    <br>
	    <span class="smallrellink">
	    SDSS Galaxy Colo...
	    </span>
	    <span class="hiddenrellink">
	    SDSS Galaxy Colors
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
	<div class="spacer">
	&nbsp;
	</div>
	<div class="rellink">
	<a href="index.html" title="Data set Examples" >
	Up
	<br>
	<span class="smallrellink">
	Data set Example...
	</span>
	<span class="hiddenrellink">
	Data set Examples
	</span>
	
	</a>
	</div>
    </div>
    <p style="text-align: center">This documentation is
    for astroML <strong>version 0.1</strong>
    &mdash; <a href="http://scikit-learn.org/stable/support.html#documentation-resources">Other versions</a></p>
        

	

        <h3>This page</h3>
         <ul>
<li><a class="reference internal" href="#">Plot the power spectrum of LIGO</a></li>
</ul>


        

	<h3>Links</h3>
	<p><a href="https://groups.google.com/forum/#!forum/astroml-general">astroML Mailing List</a></p>
	<p><a href="http://github.com/astroML/astroML/issues">GitHub Issue Tracker</a>.</p>

        

        </div>

      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="plot-the-power-spectrum-of-ligo">
<span id="example-datasets-plot-ligo-spectrum"></span><h1>Plot the power spectrum of LIGO<a class="headerlink" href="#plot-the-power-spectrum-of-ligo" title="Permalink to this headline">Â¶</a></h1>
<p>This compares the power spectrum computed using the raw FFT, and using
Welch&#8217;s method (i.e. overlapping window functions that reduce noise).
The top panel shows the raw signal, which is the measurements of the
change in baseline length.  The bottom panel shows the raw and smoothed
power spectrum, used by the LIGO team to characterize the noise
of the detector.  The particular data used here is the injected
<a class="reference external" href="http://www.ligo.org/news/blind-injection.php">Big Dog</a> event.</p>
<img alt="../../_images/plot_LIGO_spectrum_1.png" class="align-center" src="../../_images/plot_LIGO_spectrum_1.png" style="width: 100%;" />
<div class="toggle_trigger"><a href="#"><p><strong>Code output:</strong></p>
</a></div>
<div class="toggle_container"><div class="highlight-python"><pre>downloading LIGO bigdog data from http://www.astro.washington.edu/users/ivezic/DMbook/LIGO/hoft.968653908-968655956.H1.dat.gz to /home/vanderplas/astroML_data/LIGO_large.npy
Downloading http://www.astro.washington.edu/users/ivezic/DMbook/LIGO/hoft.968653908-968655956.H1.dat.gz
[=                                      ]  2.16Mb / 86.53Mb   [==                                     ]  4.33Mb / 86.53Mb   [===                                    ]  6.49Mb / 86.53Mb   [====                                   ]  8.65Mb / 86.53Mb   [=====                                  ]  10.82Mb / 86.53Mb   [======                                 ]  12.98Mb / 86.53Mb   [=======                                ]  15.14Mb / 86.53Mb   [========                               ]  17.31Mb / 86.53Mb   [=========                              ]  19.47Mb / 86.53Mb   [==========                             ]  21.63Mb / 86.53Mb   [===========                            ]  23.80Mb / 86.53Mb   [============                           ]  25.96Mb / 86.53Mb   [=============                          ]  28.12Mb / 86.53Mb   [==============                         ]  30.29Mb / 86.53Mb   [===============                        ]  32.45Mb / 86.53Mb   [================                       ]  34.61Mb / 86.53Mb   [=================                      ]  36.78Mb / 86.53Mb   [==================                     ]  38.94Mb / 86.53Mb   [===================                    ]  41.10Mb / 86.53Mb   [====================                   ]  43.26Mb / 86.53Mb   [=====================                  ]  45.43Mb / 86.53Mb   [======================                 ]  47.59Mb / 86.53Mb   [=======================                ]  49.75Mb / 86.53Mb   [========================               ]  51.92Mb / 86.53Mb   [=========================              ]  54.08Mb / 86.53Mb   [==========================             ]  56.24Mb / 86.53Mb   [===========================            ]  58.41Mb / 86.53Mb   [============================           ]  60.57Mb / 86.53Mb   [=============================          ]  62.73Mb / 86.53Mb   [==============================         ]  64.90Mb / 86.53Mb   [===============================        ]  67.06Mb / 86.53Mb   [================================       ]  69.22Mb / 86.53Mb   [=================================      ]  71.39Mb / 86.53Mb   [==================================     ]  73.55Mb / 86.53Mb   [===================================    ]  75.71Mb / 86.53Mb   [====================================   ]  77.88Mb / 86.53Mb   [=====================================  ]  80.04Mb / 86.53Mb   [====================================== ]  82.20Mb / 86.53Mb   [=======================================]  84.37Mb / 86.53Mb   [========================================]  86.53Mb / 86.53Mb   [=========================================]  86.53Mb / 86.53Mb   
uncompressing file...
</pre>
</div>
</div>
<div class="toggle_trigger" id="start_open"><a href="#"><p><strong>Python source code:</strong></p>
</a></div>
<div class="toggle_container"><div class="highlight-python"><div class="highlight"><pre><span class="c"># Author: Jake VanderPlas &lt;vanderplas@astro.washington.edu&gt;</span>
<span class="c"># License: BSD</span>
<span class="c">#   The figure is an example from astroML: see http://astroML.github.com</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fftpack</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">mlab</span>

<span class="kn">from</span> <span class="nn">astroML.datasets</span> <span class="kn">import</span> <span class="n">fetch_LIGO_large</span>

<span class="c">#------------------------------------------------------------</span>
<span class="c"># Fetch the LIGO hanford data</span>
<span class="n">data</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">fetch_LIGO_large</span><span class="p">()</span>

<span class="c"># subset of the data to plot</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">646</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">tplot</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">dplot</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4096</span> <span class="o">*</span> <span class="n">t0</span><span class="p">:</span> <span class="mi">4096</span> <span class="o">*</span> <span class="p">(</span><span class="n">t0</span> <span class="o">+</span> <span class="n">T</span><span class="p">)]</span>

<span class="n">tplot</span> <span class="o">=</span> <span class="n">tplot</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>
<span class="n">dplot</span> <span class="o">=</span> <span class="n">dplot</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>

<span class="n">fmin</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">fmax</span> <span class="o">=</span> <span class="mi">2060</span>

<span class="c">#------------------------------------------------------------</span>
<span class="c"># compute PSD using simple FFT</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">PSD</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dt</span> <span class="o">*</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">)[:</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">df</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">cutoff</span> <span class="o">=</span> <span class="p">((</span><span class="n">f</span> <span class="o">&gt;=</span> <span class="n">fmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">f</span> <span class="o">&lt;=</span> <span class="n">fmax</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">cutoff</span><span class="p">]</span>
<span class="n">PSD</span> <span class="o">=</span> <span class="n">PSD</span><span class="p">[</span><span class="n">cutoff</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">[::</span><span class="mi">100</span><span class="p">]</span>
<span class="n">PSD</span> <span class="o">=</span> <span class="n">PSD</span><span class="p">[::</span><span class="mi">100</span><span class="p">]</span>

<span class="c">#------------------------------------------------------------</span>
<span class="c"># compute PSD using Welch&#39;s method -- hanning window function</span>
<span class="n">PSDW2</span><span class="p">,</span> <span class="n">fW2</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">dt</span><span class="p">,</span>
                      <span class="n">window</span><span class="o">=</span><span class="n">mlab</span><span class="o">.</span><span class="n">window_hanning</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>

<span class="n">dfW2</span> <span class="o">=</span> <span class="n">fW2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fW2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">fW2</span> <span class="o">&gt;=</span> <span class="n">fmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fW2</span> <span class="o">&lt;=</span> <span class="n">fmax</span><span class="p">)</span>
<span class="n">fW2</span> <span class="o">=</span> <span class="n">fW2</span><span class="p">[</span><span class="n">cutoff</span><span class="p">]</span>
<span class="n">PSDW2</span> <span class="o">=</span> <span class="n">PSDW2</span><span class="p">[</span><span class="n">cutoff</span><span class="p">]</span>

<span class="c">#------------------------------------------------------------</span>
<span class="c"># Plot the data</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c"># top panel: time series</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tplot</span><span class="p">,</span> <span class="n">dplot</span><span class="p">,</span> <span class="s">&#39;-k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$h(t)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2E-18</span><span class="p">,</span> <span class="mf">1.2E-18</span><span class="p">)</span>

<span class="c"># bottom panel: hanning window</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">PSD</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;#AAAAAA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fW2</span><span class="p">,</span> <span class="n">PSDW2</span><span class="p">,</span> <span class="s">&#39;-k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s">&quot;Hanning (cosine) window&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&#39;$PSD(f)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">2060</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1E-46</span><span class="p">,</span> <span class="mf">1E-36</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div align="right"><p><a class="reference download internal" href="../../_downloads/plot_LIGO_spectrum.py"><tt class="xref download docutils literal"><span class="pre">[download</span> <span class="pre">source:</span> <span class="pre">plot_LIGO_spectrum.py]</span></tt></a></p>
</div></div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
        <p style="text-align: center">This documentation is relative
        to astroML version 0.1<p>
        &copy; 2012, Jake Vanderplas.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3. Design by <a href="http://webylimonada.com">Web y Limonada</a>.
    <span style="padding-left: 5ex;">
    <a href="../../_sources/examples/datasets/plot_LIGO_spectrum.txt"
	    rel="nofollow">Show this page source</a>
    </span>
    </div>
  </body>
</html>